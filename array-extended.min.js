/*! array-extended - v0.0.4 - 2013-02-19
* Copyright (c) 2013 Doug Martin; Licensed MIT */
(function(){"use strict";function t(t,n){return n=n||0,e.call(t,n)}function n(e,n){function b(e,t){return M(t,function(t,n){return i(n)||(n=[n]),n.unshift(e),t.unshift(n),t},[])}function w(e,t,n){var r=[];for(var i=0;i<t.length;i++)r.push([e].concat(R(t,i)).slice(0,n));return r}function E(e,t){var n=[],r;if(e&&t&&e.length&&t.length)for(var i=0,s=e.length;i<s;i++)r=e[i],x(t,r)!==-1&&n.push(r);return n}function x(e,t,n){if(e&&c&&c===e.indexOf)return e.indexOf(t,n);if(!i(e))throw new TypeError;var r=Object(e),s=r.length>>>0;if(s===0)return-1;var f=0;arguments.length>2&&(f=Number(arguments[2]),f!==f?f=0:f!==0&&f!==Infinity&&f!==-Infinity&&(f=(f>0||-1)*o(u(f))));if(f>=s)return-1;var l=f>=0?f:a(s-u(f),0);for(;l<s;l++)if(l in r&&r[l]===t)return l;return-1}function T(e,t,n){if(!i(e))throw new TypeError;var r=Object(e),s=r.length>>>0;if(s===0)return-1;var a=s;arguments.length>2&&(a=Number(arguments[2]),a!==a?a=0:a!==0&&a!==1/0&&a!==-1/0&&(a=(a>0||-1)*o(u(a))));var l=a>=0?f(a,s-1):s-u(a);for(;l>=0;l--)if(l in r&&r[l]===t)return l;return-1}function N(e,t,n){if(e&&m&&m===e.filter)return e.filter(t,n);if(!i(e)||typeof t!="function")throw new TypeError;var r=Object(e),s=r.length>>>0,o=[];for(var u=0;u<s;u++)if(u in r){var a=r[u];t.call(n,a,u,r)&&o.push(a)}return o}function C(e,t,n){if(!i(e)||typeof t!="function")throw new TypeError;if(e&&h&&h===e.forEach)return e.forEach(t,n),e;for(var r=0,s=e.length;r<s;++r)t.call(n||e,e[r],r,e);return e}function k(e,t,n){if(e&&g&&g===e.every)return e.every(t,n);if(!i(e)||typeof t!="function")throw new TypeError;var r=Object(e),s=r.length>>>0;for(var o=0;o<s;o++)if(o in r&&!t.call(n,r[o],o,r))return!1;return!0}function L(e,t,n){if(e&&y&&y===e.some)return e.some(t,n);if(!i(e)||typeof t!="function")throw new TypeError;var r=Object(e),s=r.length>>>0;for(var o=0;o<s;o++)if(o in r&&t.call(n,r[o],o,r))return!0;return!1}function A(e,t,n){if(e&&p&&p===e.map)return e.map(t,n);if(!i(e)||typeof t!="function")throw new TypeError;var r=Object(e),s=r.length>>>0,o=[];for(var u=0;u<s;u++)u in r&&o.push(t.call(n,r[u],u,r));return o}function O(e,t,n){var r=arguments.length>2;if(e&&d&&d===e.reduce)return r?e.reduce(t,n):e.reduce(t);if(!i(e)||typeof t!="function")throw new TypeError;var s=0,o=e.length>>0;if(arguments.length<3){if(o===0)throw new TypeError("Array length is 0 and no second argument");n=e[0],s=1}else n=arguments[2];while(s<o)s in e&&(n=t.call(undefined,n,e[s],s,e)),++s;return n}function M(e,t,n){var r=arguments.length>2;if(e&&v&&v===e.reduceRight)return r?e.reduceRight(t,n):e.reduceRight(t);if(!i(e)||typeof t!="function")throw new TypeError;var s=Object(e),o=s.length>>>0;if(o===0&&arguments.length===2)throw new TypeError;var u=o-1;if(arguments.length>=3)n=arguments[2];else do if(u in e){n=e[u--];break}while(!0);while(u>=0)u in s&&(n=t.call(undefined,n,s[u],u,s)),u--;return n}function _(e){var r=[];if(e!==null){var s=t(arguments);if(s.length===1)if(i(e))r=e;else if(n.isHash(e))for(var o in e)e.hasOwnProperty(o)&&r.push([o,e[o]]);else r.push(e);else C(s,function(e){r=r.concat(_(e))})}return r}function D(e){return e=e||[],e.length?O(e,function(e,t){return e+t}):0}function P(e){e=e||[];if(e.length){var t=D(e);if(n.isNumber(t))return t/e.length;throw new Error("Cannot average an array of non numbers.")}return 0}function H(e,t){return S(e,t)}function B(e,t){return S(e,t)[0]}function j(e,t){return S(e,t)[e.length-1]}function F(e){var n=e,r=Y(t(arguments,1));return i(e)&&(n=N(e,function(e){return x(r,e)===-1})),n}function I(e){var t=[];if(i(e))for(var n=0,r=e.length;n<r;n++){var s=e[n];x(t,s)===-1&&t.push(s)}return t}function q(e){return I(e)}function R(e,t){var n=e.slice();return typeof t!="number"&&(t=1),t&&i(e)?(t>0?(n.push(n.shift()),t--):(n.unshift(n.pop()),t++),R(n,t)):n}function U(e,t){var n=[];if(i(e)){var r=e.slice(0);typeof t!="number"&&(t=e.length),t?t<=e.length&&(n=O(e,function(e,n,i){var s;return t>1?s=w(n,R(r,i).slice(1),t):s=[[n]],e.concat(s)},[])):n=[[]]}return n}function z(){var e=[],r=t(arguments);if(r.length>1){var s=r.shift();i(s)&&(e=O(s,function(e,t,s){var o=[t];for(var u=0;u<r.length;u++){var a=r[u];i(a)&&!n.isUndefined(a[s])?o.push(a[s]):o.push(null)}return e.push(o),e},[]))}return e}function W(e){var t=[];if(i(e)&&e.length){var n;C(e,function(e){i(e)&&(!n||e.length===n.length)&&(C(e,function(e,n){t[n]||(t[n]=[]),t[n].push(e)}),n=e)})}return t}function X(e,n){var r=[];n=t(arguments),e=n.shift();if(i(e)&&n.length)for(var s=0,o=n.length;s<o;s++)r.push(e[n[s]]||null);return r}function V(){var e=[],n=t(arguments);if(n.length>1){for(var r=0,i=n.length;r<i;r++)e=e.concat(n[r]);e=I(e)}return e}function $(){var e=[],n,r=t(arguments);r.length>1?n=r:n=r[0];if(i(n)){var e=n.shift();for(var s=0,o=n.length;s<o;s++)e=E(e,n[s])}return I(e)}function J(e){var t=[];return i(e)&&e.length&&(t=O(e,function(e,t){var n=A(e,function(e){return e.concat(t)});return e.concat(n)},[[]])),t}function K(e,t){var n=[];return i(e)&&i(t)&&e.length&&t.length&&(n=b(e[0],t).concat(K(e.slice(1),t))),n}function Q(e){var t=[];return i(e)&&e.length&&(t=N(e,function(e){return!n.isUndefinedOrNull(e)})),t}function G(e,t){t=n.isNumber(t)?t:1,t||(t=1),e=_(e||[]);var r=[],i=0;while(++i<=t)r=r.concat(e);return r}function Y(e){var n,r=t(arguments);return r.length>1?n=r:n=_(e),O(n,function(e,t){return e.concat(t)},[])}function Z(e,t){t=t.split(".");var n=e.slice(0);return C(t,function(e){var t=e.match(/(\w+)\(\)$/);n=A(n,function(n){return t?n[t[1]]():n[e]})}),n}function et(e,n,i){return i=t(arguments,2),A(e,function(e){var t=r(n)?e[n]:n;return t.apply(e,i)})}var r=n.isString,i=Array.isArray||n.isArray,s=n.isDate,o=Math.floor,u=Math.abs,a=Math.max,f=Math.min,l=Array.prototype,c=l.indexOf,h=l.forEach,p=l.map,d=l.reduce,v=l.reduceRight,m=l.filter,g=l.every,y=l.some,S=function(){var e=function(e,t){return k(e,t)},t=function(e,t){return e-t},n=function(e,t){return e.getTime()-t.getTime()};return function(u,a){var f=[];return i(u)&&(f=u.slice(),a?typeof a=="function"?f.sort(a):f.sort(function(e,t){var n=e[a],i=t[a];return r(n)&&r(i)?n>i?1:n<i?-1:0:s(n)&&s(i)?n.getTime()-i.getTime():n-i}):e(f,r)?f.sort():e(f,s)?f.sort(n):f.sort(t)),f}}(),tt={toArray:_,sum:D,avg:P,sort:H,min:B,max:j,difference:F,removeDuplicates:I,unique:q,rotate:R,permutations:U,zip:z,transpose:W,valuesAt:X,union:V,intersect:$,powerSet:J,cartesian:K,compact:Q,multiply:G,flatten:Y,pluck:Z,invoke:et,forEach:C,map:A,filter:N,reduce:O,reduceRight:M,some:L,every:k,indexOf:x,lastIndexOf:T};return e.define(i,tt).expose(tt)}var e=Array.prototype.slice;"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(module.exports=n(require("extended"),require("is-extended"))):"function"==typeof define?define(["require"],function(e){return n(e("extended"),e("is-extended"))}):this.arrayExtended=n(this.extended,this.isExtended)}).call(this);